import{I as U}from"./ImageCarousel-fbeacc5f.js";import{d as q,s as W,m as L,a as Y,u as G,r as v,D as Q,o as J,e as n,f as c,j as e,t as d,F as N,n as S,B as r,z as u,L as K,A as f,p as y,q as k,x as O,i as m,a4 as X,a0 as R,a2 as B,y as F}from"./index-a935e8ad.js";import{r as Z}from"./CheckCircleIcon-bcebf7d0.js";const ee={class:"bg-white p-4 rounded-xl shadow transition-shadow duration-300 hover:shadow-xl"},te={key:0},se={class:"flex flex-row gap-2 items-end mb-2 bg-gradient-to-r from-sky-500/50 to-white rounded-md"},ae=["src"],oe={class:"flex flex-col"},ne={class:"flex flex-row gap-1"},ie=e("p",{class:"text-xs italic"},[e("span",{class:"text-sky-500 font-bold"},"v"),m("erified")],-1),de={class:"text-xs italic"},le={class:"text-xs italic pl-2"},re={class:"text-xs italic pl-2"},ce={key:1,class:"w-full flex items-center justify-center h-24"},ue={class:"text-xl font-semibold mb-2 capitalize"},me={class:"w-full h-96 object-cover rounded-lg"},ve={key:1,class:"flex items-center justify-center h-full"},fe=e("p",{class:"text-gray-500"},"No Image Available",-1),ye=[fe],xe={class:"overflow-hidden rounded-lg shadow-md mt-4"},ge={class:"min-w-full"},he=e("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Type:",-1),be={class:"border px-4 py-2 text-sm"},we=e("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Variety:",-1),Se={class:"border px-4 py-2 text-sm"},ke=e("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Price per Ton:",-1),pe={class:"border px-4 py-2 text-sm"},Te=e("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Quantity:",-1),Ce={class:"border px-4 py-2 text-sm"},Ae=e("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Expected Harvest Date:",-1),Ee={class:"border px-4 py-2 text-sm"},De=e("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Bidding End Time:",-1),$e={class:"border px-4 py-2 text-sm"},Le={key:1},Ne={colspan:"2",class:"border px-4 py-2 text-sm font-medium"},Oe={key:2,class:"flex items-center justify-end mt-2 space-x-4"},Me=q({__name:"SellerAdCard",props:{ad:{type:Object,required:!0},showButtons:{type:Boolean,default:!0}},emits:["edit"],setup(t,{emit:Re}){const{modals:p,notifications:i}=W(L()),x=L().NOTIFICATION_TYPES,g=Y().AD_STATUSES,b=G(),j=t,T=v(!1),C=v(!1),M=async a=>{if(!a)return;const{callFunction:s}=F("postAd",{adId:a},C,void 0,void 0,()=>{i.value.show=!0,i.value.type=x.SUCCESS,i.value.message="Ad is live!"},l=>{i.value.show=!0,i.value.type=x.ERROR,i.value.message="Error while posting ad, please try again later"});await s()},A=v(!0),_=async a=>{if(!a)return;const{callFunction:s}=F("removeAd",{adId:a},A,void 0,void 0,()=>{i.value.show=!0,i.value.type=x.SUCCESS,i.value.message="Ad removed!"},l=>{i.value.show=!0,i.value.type=x.ERROR,i.value.message="Error while removing ad, please try again later"});await s()},P=a=>{a&&b.push({name:"ad",params:{adId:a}})},V=async a=>{a&&(console.log("removeAd",a),p.value.editad=!0,p.value.context=ads.value.docs.find(s=>s.id===a))},I=a=>{a&&b.push({name:"messaging",params:{adId:a}})},o=v(null),h=v(!1),z=async a=>{a&&(h.value=!0,o.value=await X("ads",a),h.value=!1)},H=Q(()=>{if(!o.value)return;const a=new Date,s=new Date(o.value.createdAt.toDate().toString()),l=a.getTime()-s.getTime(),D=Math.floor(l/(1e3*60*60*24)),w=Math.floor(D/31),$=Math.floor(w/12);return $>0?`${$} yrs`:w>0?`${w} mths`:`${D} days`}),E=(a,s)=>{console.log("go to seller ads",a),b.push({name:"seller-ads",params:{id:a,sellerName:s}})};return J(async()=>{await z(j.ad.uid)}),(a,s)=>(n(),c("div",ee,[!h.value&&o.value?(n(),c("div",te,[e("span",se,[e("img",{src:o.value.storeLogoResized,class:"w-10 h-10 rounded-md object-cover bg-slate-500 cursor-pointer",onClick:s[0]||(s[0]=l=>E(o.value.id,o.value.companyName))},null,8,ae),e("span",oe,[e("h1",{class:"text-md font-bold capitalize cursor-pointer",onClick:s[1]||(s[1]=l=>E(o.value.id,o.value.companyName))},d(`${o.value.companyName}`),1),e("div",ne,[o.value.verifiedSeller?(n(),c(N,{key:0},[S(r(Z),{class:"h-4 w-4 text-sky-500"}),ie,e("p",de,d(H.value),1)],64)):u("",!0),e("p",le,d(o.value.staffNumber)+"+ staff",1),e("p",re,d(o.value.acreage)+"+ acres",1)])])])])):(n(),c("div",ce,[S(K,{isLoading:h.value},null,8,["isLoading"])])),e("h3",ue,d(`${t.ad.variety}`),1),e("div",me,[t.ad.images&&t.ad.images.length>0?(n(),f(U,{key:0,images:t.ad.resizedImages,classes:"h-96"},null,8,["images"])):(n(),c("div",ve,ye))]),e("div",xe,[e("table",ge,[e("tbody",null,[e("tr",null,[he,e("td",be,d(t.ad.type),1)]),e("tr",null,[we,e("td",Se,d(t.ad.variety),1)]),e("tr",null,[ke,e("td",pe,d(t.ad.pricePerTon),1)]),e("tr",null,[Te,e("td",Ce,d(t.ad.tons),1)]),T.value?(n(),c(N,{key:0},[e("tr",null,[Ae,e("td",Ee,d(r(R)(t.ad.expectedHarvestDate)?r(B)(t.ad.expectedHarvestDate):t.ad.expectedHarvestDate),1)]),e("tr",null,[De,e("td",$e,d(r(R)(t.ad.biddingEndTime)?r(B)(t.ad.biddingEndTime):t.ad.biddingEndTime),1)])],64)):(n(),c("tr",Le,[e("td",Ne,[e("button",{class:"text-sky-500 hover:underline",onClick:s[2]||(s[2]=l=>T.value=!0)},"Show More")])]))])])]),t.showButtons?(n(),c("div",Oe,[!t.ad.live&&t.ad.status!=r(g).SOLD?(n(),f(k,{key:0,onClick:s[3]||(s[3]=l=>V(t.ad.id))},{default:y(()=>[m(" Edit ")]),_:1})):u("",!0),!t.ad.live&&t.ad.status==r(g).SOLD?(n(),f(k,{key:1,classes:"truncate",onClick:s[4]||(s[4]=l=>I(t.ad.id))},{default:y(()=>[m(" Contact Winner ")]),_:1})):u("",!0),!t.ad.live&&t.ad.status!=r(g).SOLD?(n(),f(O,{key:2,disabled:t.ad.live,isLoading:C.value,onClick:s[5]||(s[5]=l=>M(t.ad.id))},{default:y(()=>[m(" Post "+d(t.ad.status),1)]),_:1},8,["disabled","isLoading"])):u("",!0),S(k,{onClick:s[6]||(s[6]=l=>P(t.ad.id))},{default:y(()=>[m(" View ")]),_:1}),!t.ad.live&&t.ad.status!=r(g).SOLD?(n(),f(O,{key:3,disabled:t.ad.live,isLoading:A.value==t.ad.id,onClick:s[7]||(s[7]=l=>_(t.ad.id))},{default:y(()=>[m(" Remove ")]),_:1},8,["disabled","isLoading"])):u("",!0)])):u("",!0)]))}});export{Me as _};
