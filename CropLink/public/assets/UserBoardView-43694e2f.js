import{h as _,o as D,N as be,O as x,d as E,P as V,Q as we,R as me,S as w,T as U,U as Z,V as ge,W as Y,X as Se,F as j,Y as xe,Z as _e,$ as Q,a0 as ee,a1 as q,a2 as $,a3 as M,a4 as Te,a5 as ke,a6 as N,a7 as C,e as b,f as h,k as z,y as O,a as W,u as Ae,g as c,t as F,l as g,z as te,A as ae,q as P,i as J,C as $e,x as G,s as se,B as Ce,p as B,a8 as le,G as ne,H as ue,I as oe,J as re,K as ie,a9 as de,L as ce,M as ve}from"./index-b6562c70.js";import{_ as Ie}from"./SellerAdCard.vue_vue_type_script_setup_true_lang-f9c7b84b.js";import{_ as Be}from"./BuyerAdCard.vue_vue_type_script_setup_true_lang-c90f8431.js";function fe(t,r){if(t)return t;let o=r??"button";if(typeof o=="string"&&o.toLowerCase()==="button")return"button"}function Pe(t,r){let o=_(fe(t.value.type,t.value.as));return D(()=>{o.value=fe(t.value.type,t.value.as)}),be(()=>{var d;o.value||x(r)&&x(r)instanceof HTMLButtonElement&&!((d=x(r))!=null&&d.hasAttribute("type"))&&(o.value="button")}),o}let Ee=E({props:{onFocus:{type:Function,required:!0}},setup(t){let r=_(!0);return()=>r.value?V(me,{as:"button",type:"button",features:we.Focusable,onFocus(o){o.preventDefault();let d,l=50;function s(){var i;if(l--<=0){d&&cancelAnimationFrame(d);return}if((i=t.onFocus)!=null&&i.call(t)){r.value=!1,cancelAnimationFrame(d);return}d=requestAnimationFrame(s)}d=requestAnimationFrame(s)}}):null}});var Le=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(Le||{}),Oe=(t=>(t[t.Less=-1]="Less",t[t.Equal=0]="Equal",t[t.Greater=1]="Greater",t))(Oe||{});let he=Symbol("TabsContext");function H(t){let r=Q(he,null);if(r===null){let o=new Error(`<${t} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,H),o}return r}let X=Symbol("TabsSSRContext"),Ne=E({name:"TabGroup",emits:{change:t=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:r,attrs:o,emit:d}){var l;let s=_((l=t.selectedIndex)!=null?l:t.defaultIndex),i=_([]),v=_([]),p=w(()=>t.selectedIndex!==null),n=w(()=>p.value?t.selectedIndex:s.value);function f(a){var e;let u=U(m.tabs.value,x),y=U(m.panels.value,x),k=u.filter(T=>{var A;return!((A=x(T))!=null&&A.hasAttribute("disabled"))});if(a<0||a>u.length-1){let T=q(s.value===null?0:Math.sign(a-s.value),{[-1]:()=>1,0:()=>q(Math.sign(a),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),A=q(T,{0:()=>u.indexOf(k[0]),1:()=>u.indexOf(k[k.length-1])});A!==-1&&(s.value=A),m.tabs.value=u,m.panels.value=y}else{let T=u.slice(0,a),A=[...u.slice(a),...T].find(ye=>k.includes(ye));if(!A)return;let K=(e=u.indexOf(A))!=null?e:m.selectedIndex.value;K===-1&&(K=m.selectedIndex.value),s.value=K,m.tabs.value=u,m.panels.value=y}}let m={selectedIndex:w(()=>{var a,e;return(e=(a=s.value)!=null?a:t.defaultIndex)!=null?e:null}),orientation:w(()=>t.vertical?"vertical":"horizontal"),activation:w(()=>t.manual?"manual":"auto"),tabs:i,panels:v,setSelectedIndex(a){n.value!==a&&d("change",a),p.value||f(a)},registerTab(a){var e;if(i.value.includes(a))return;let u=i.value[s.value];i.value.push(a),i.value=U(i.value,x);let y=(e=i.value.indexOf(u))!=null?e:s.value;y!==-1&&(s.value=y)},unregisterTab(a){let e=i.value.indexOf(a);e!==-1&&i.value.splice(e,1)},registerPanel(a){v.value.includes(a)||(v.value.push(a),v.value=U(v.value,x))},unregisterPanel(a){let e=v.value.indexOf(a);e!==-1&&v.value.splice(e,1)}};Z(he,m);let S=_({tabs:[],panels:[]}),L=_(!1);D(()=>{L.value=!0}),Z(X,w(()=>L.value?null:S.value));let I=w(()=>t.selectedIndex);return D(()=>{ge([I],()=>{var a;return f((a=t.selectedIndex)!=null?a:t.defaultIndex)},{immediate:!0})}),be(()=>{if(!p.value||n.value==null||m.tabs.value.length<=0)return;let a=U(m.tabs.value,x);a.some((e,u)=>x(m.tabs.value[u])!==x(e))&&m.setSelectedIndex(a.findIndex(e=>x(e)===x(m.tabs.value[n.value])))}),()=>{let a={selectedIndex:s.value};return V(j,[i.value.length<=0&&V(Ee,{onFocus:()=>{for(let e of i.value){let u=x(e);if((u==null?void 0:u.tabIndex)===0)return u.focus(),!0}return!1}}),Y({theirProps:{...o,...Se(t,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:a,slots:r,attrs:o,name:"TabGroup"})])}}}),Fe=E({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(t,{attrs:r,slots:o}){let d=H("TabList");return()=>{let l={selectedIndex:d.selectedIndex.value},s={role:"tablist","aria-orientation":d.orientation.value};return Y({ourProps:s,theirProps:t,slot:l,attrs:r,slots:o,name:"TabList"})}}}),pe=E({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-tabs-tab-${xe()}`}},setup(t,{attrs:r,slots:o,expose:d}){let l=H("Tab"),s=_(null);d({el:s,$el:s}),D(()=>l.registerTab(s)),_e(()=>l.unregisterTab(s));let i=Q(X),v=w(()=>{if(i.value){let e=i.value.tabs.indexOf(t.id);return e===-1?i.value.tabs.push(t.id)-1:e}return-1}),p=w(()=>{let e=l.tabs.value.indexOf(s);return e===-1?v.value:e}),n=w(()=>p.value===l.selectedIndex.value);function f(e){var u;let y=e();if(y===M.Success&&l.activation.value==="auto"){let k=(u=ke(s))==null?void 0:u.activeElement,T=l.tabs.value.findIndex(A=>x(A)===k);T!==-1&&l.setSelectedIndex(T)}return y}function m(e){let u=l.tabs.value.map(y=>x(y)).filter(Boolean);if(e.key===$.Space||e.key===$.Enter){e.preventDefault(),e.stopPropagation(),l.setSelectedIndex(p.value);return}switch(e.key){case $.Home:case $.PageUp:return e.preventDefault(),e.stopPropagation(),f(()=>N(u,C.First));case $.End:case $.PageDown:return e.preventDefault(),e.stopPropagation(),f(()=>N(u,C.Last))}if(f(()=>q(l.orientation.value,{vertical(){return e.key===$.ArrowUp?N(u,C.Previous|C.WrapAround):e.key===$.ArrowDown?N(u,C.Next|C.WrapAround):M.Error},horizontal(){return e.key===$.ArrowLeft?N(u,C.Previous|C.WrapAround):e.key===$.ArrowRight?N(u,C.Next|C.WrapAround):M.Error}}))===M.Success)return e.preventDefault()}let S=_(!1);function L(){var e;S.value||(S.value=!0,!t.disabled&&((e=x(s))==null||e.focus({preventScroll:!0}),l.setSelectedIndex(p.value),Te(()=>{S.value=!1})))}function I(e){e.preventDefault()}let a=Pe(w(()=>({as:t.as,type:r.type})),s);return()=>{var e;let u={selected:n.value},{id:y,...k}=t,T={ref:s,onKeydown:m,onMousedown:I,onClick:L,id:y,role:"tab",type:a.value,"aria-controls":(e=x(l.panels.value[p.value]))==null?void 0:e.id,"aria-selected":n.value,tabIndex:n.value?0:-1,disabled:t.disabled?!0:void 0};return Y({ourProps:T,theirProps:k,slot:u,attrs:r,slots:o,name:"Tab"})}}}),R=E({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-tabs-panel-${xe()}`},tabIndex:{type:Number,default:0}},setup(t,{attrs:r,slots:o,expose:d}){let l=H("TabPanel"),s=_(null);d({el:s,$el:s}),D(()=>l.registerPanel(s)),_e(()=>l.unregisterPanel(s));let i=Q(X),v=w(()=>{if(i.value){let f=i.value.panels.indexOf(t.id);return f===-1?i.value.panels.push(t.id)-1:f}return-1}),p=w(()=>{let f=l.panels.value.indexOf(s);return f===-1?v.value:f}),n=w(()=>p.value===l.selectedIndex.value);return()=>{var f;let m={selected:n.value},{id:S,tabIndex:L,...I}=t,a={ref:s,id:S,role:"tabpanel","aria-labelledby":(f=x(l.tabs.value[p.value]))==null?void 0:f.id,tabIndex:n.value?L:-1};return!n.value&&t.unmount&&!t.static?V(me,{as:"span",...a}):Y({ourProps:a,theirProps:I,slot:m,attrs:r,slots:o,features:ee.Static|ee.RenderStrategy,visible:n.value,name:"TabPanel"})}}});const De={class:"grid grid-flow-col space-x-4"},Ue=E({__name:"SellerContentComponent",props:{ads:{type:Array,required:!0}},setup(t){return(r,o)=>(b(),h("span",De,[(b(!0),h(j,null,z(t.ads,(d,l)=>(b(),O(Ie,{key:l,ad:d},null,8,["ad"]))),128))]))}}),Ge=E({__name:"BuyerContentComponent",props:{ads:{type:Array,required:!0}},setup(t){return(r,o)=>(b(),h("span",null,[(b(!0),h(j,null,z(t.ads,(d,l)=>(b(),O(Be,{key:l,ad:d},null,8,["ad"]))),128))]))}}),je={class:"grid grid-flow-row space-y-4"},Me={class:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 mb-4"},Re={class:"flex flex-row"},qe={class:"flex flex-row space-x-4"},Ve=c("label",{class:"block text-sm font-medium text-gray-700"},"Buyer",-1),We={class:"text-sm"},Ye={class:"flex flex-row space-x-4"},ze=c("label",{class:"block text-sm font-medium text-gray-700"},"Offer",-1),He={class:"text-sm"},Ke={class:"flex flex-row space-x-4"},Je=c("label",{class:"block text-sm font-medium text-gray-700"},"Time",-1),Qe={class:"text-sm"},Xe={class:"flex flex-row space-x-4"},Ze=c("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1),et={class:"text-sm"},tt={class:"flex flex-row space-x-4"},at=c("label",{class:"block text-sm font-medium text-gray-700"},"Last updated",-1),st={class:"text-sm"},lt={class:"flex justify-end mt-2 space-x-4"},nt=["onClick"],ut=["onClick"],ot=E({__name:"BidContentComponent",props:{bids:{type:Array,required:!0}},setup(t){const r=W().BID_STATUSES,o=Ae(),d=_(""),l=async v=>{console.log("Cancelling bid",v),d.value=v,await W().cancelUserBid(v),d.value=""},s=v=>{v&&o.push({name:"ad",params:{adId:v}})},i=v=>{v&&(console.log("contactWinner",v),o.push({name:"messaging",params:{adId:v}}))};return(v,p)=>(b(),h("span",je,[(b(!0),h(j,null,z(t.bids,n=>(b(),h("div",Me,[c("div",Re,[c("span",null,[c("div",qe,[Ve,c("p",We,F(n.buyerId.substring(0,5)),1)]),c("div",Ye,[ze,c("p",He,F(n.price),1)]),c("div",Ke,[Je,c("p",Qe,F(g(te)(n.createdAt)?g(ae)(n.createdAt):n.createdAt),1)])]),c("span",null,[c("div",Xe,[Ze,c("p",et,F(n.status),1)]),c("div",tt,[at,c("p",st,F(g(te)(n.updatedAt)?g(ae)(n.updatedAt):n.updatedAt),1)])])]),c("div",lt,[n.status===g(r).PENDING?(b(),O($e,{key:0,isLoading:d.value==n.id,onClick:f=>l(n.id),class:"mt-2 mb-2 inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},{default:P(()=>[J(" Cancel Bid ")]),_:2},1032,["isLoading","onClick"])):G("",!0),c("button",{onClick:f=>s(n.adId),class:"inline-flex justify-center rounded-md border border-transparent bg-green-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"}," View ",8,nt),c("button",{onClick:f=>i(n.adId),class:"inline-flex justify-center rounded-md border border-transparent bg-green-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},"Contact",8,ut)])]))),256))]))}}),rt={class:"w-full px-2 py-3 sm:px-0"},it={key:0,class:"w-full"},dt={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ct={key:1},vt={key:2},ft=c("div",null,"No ads found",-1),pt=[ft],bt={key:1},mt={key:2},gt=c("p",null,"No bids yet",-1),xt=[gt],wt=E({__name:"UserBoardView",setup(t){const{profile:r,user:o}=se(W()),{modals:d}=se(Ce()),l=W().ACCOUNT_TYPES,s=()=>{d.value.addad=!0},i=_(0),v={ADS:"Ads",CONTRACTS:"Contracts",MESSAGES:"Messages"},p=_([]),n=_([]),f=_(!1),m=async()=>{f.value=!0,p.value=await le("ads","uid","==",o.value.uid,["createdAt","desc"],10),console.log("ads",p.value),I=ne(ue(ie(ve,"ads"),re("uid","==",o.value.uid),oe("createdAt","desc")),a=>{p.value.docs=a.docs.map(e=>(console.log("ads changed"),{id:e.id,...e.data()}))}),f.value=!1},S=_(!1),L=async()=>{S.value=!0,n.value=await le("bids","buyerId","==",o.value.uid,["createdAt","desc"],10),console.log("loadingBids",n.value),I=ne(ue(ie(ve,"bids"),re("buyerId","==",o.value.uid),oe("createdAt","desc")),a=>{n.value.docs=a.docs.map(e=>(console.log("bids changed"),{id:e.id,...e.data()}))}),S.value=!1};let I;return ge(i,async(a,e)=>{i.value==0&&await m(),i.value==3&&await L(),(e==3||e==0)&&I()}),D(async()=>{console.log("mounted"),await m()}),(a,e)=>(b(),h("div",rt,[g(r)?(b(),h("div",it,[B(g(Ne),{class:"w-full",as:"div"},{default:P(()=>[B(g(Fe),{class:"w-full flex space-x-1 rounded-xl bg-blue-900/20 p-1"},{default:P(()=>[(b(),h(j,null,z(v,(u,y,k)=>B(g(pe),{as:"template",key:y,onClick:T=>i.value=k},{default:P(({selected:T})=>[c("button",{class:de(["w-full rounded-lg py-2.5 text-sm font-medium leading-5 text-blue-700","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2",T?"bg-white shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"])},F(u),3)]),_:2},1032,["onClick"])),64)),g(r).accountType===g(l).BUYER?(b(),O(g(pe),{key:0,as:"template",onClick:e[0]||(e[0]=u=>i.value=3)},{default:P(({selected:u})=>[c("button",{class:de(["w-full rounded-lg py-2.5 text-sm font-medium leading-5 text-blue-700","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2",u?"bg-white shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"])}," Bids ",2)]),_:1})):G("",!0)]),_:1}),B(g(R),null,{default:P(()=>[c("button",{onClick:s,class:"mt-2 mb-2 w-full inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},"Add an ad"),p.value.docs&&p.value.docs.length>0&&!f.value?(b(),h("div",dt,[g(r).accountType==g(l).SELLER?(b(),O(Ue,{key:0,ads:p.value.docs?p.value.docs:[]},null,8,["ads"])):G("",!0),g(r).accountType==g(l).BUYER?(b(),O(Ge,{key:1,ads:p.value.docs?p.value.docs:[]},null,8,["ads"])):G("",!0)])):f.value?(b(),h("div",ct,[B(ce,{isLoading:f.value},null,8,["isLoading"])])):(b(),h("div",vt,pt))]),_:1}),B(g(R),null,{default:P(()=>[J(" Contract ")]),_:1}),B(g(R),null,{default:P(()=>[J(" Messages ")]),_:1}),B(g(R),null,{default:P(()=>[n.value.docs&&n.value.docs.length>0&&!S.value?(b(),O(ot,{key:0,bids:n.value.docs?n.value.docs:[]},null,8,["bids"])):S.value?(b(),h("div",bt,[B(ce,{isLoading:S.value},null,8,["isLoading"])])):(b(),h("span",mt,xt))]),_:1})]),_:1})])):G("",!0)]))}});export{wt as default};
