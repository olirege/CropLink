import{h as w,o as R,N as me,O as h,d as O,P as z,Q as we,R as ge,S as k,T as U,U as ee,V as _e,W as K,X as Ae,F as M,Y as xe,z as he,Z as X,$ as te,a0 as W,a1 as E,a2 as Y,a3 as ke,a4 as Se,a5 as j,a6 as I,e as _,f as y,k as J,g as n,p as P,t as $,i as T,q as B,a7 as ye,a as D,l as x,J as se,K as ne,A as q,x as G,s as le,y as Te,a8 as oe,C as ae,D as re,G as ie,H as ue,I as de,a9 as ce,L as ve,M as fe}from"./index-b85785d0.js";import{I as Ce}from"./ImageCarousel-19a04952.js";function pe(e,d){if(e)return e;let r=d??"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function Pe(e,d){let r=w(pe(e.value.type,e.value.as));return R(()=>{r.value=pe(e.value.type,e.value.as)}),me(()=>{var v;r.value||h(d)&&h(d)instanceof HTMLButtonElement&&!((v=h(d))!=null&&v.hasAttribute("type"))&&(r.value="button")}),r}let Ee=O({props:{onFocus:{type:Function,required:!0}},setup(e){let d=w(!0);return()=>d.value?z(ge,{as:"button",type:"button",features:we.Focusable,onFocus(r){r.preventDefault();let v,l=50;function o(){var t;if(l--<=0){v&&cancelAnimationFrame(v);return}if((t=e.onFocus)!=null&&t.call(e)){d.value=!1,cancelAnimationFrame(v);return}v=requestAnimationFrame(o)}v=requestAnimationFrame(o)}}):null}});var Ie=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Ie||{}),Be=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Be||{});let $e=Symbol("TabsContext");function Q(e){let d=X($e,null);if(d===null){let r=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Q),r}return d}let Z=Symbol("TabsSSRContext"),Le=O({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:d,attrs:r,emit:v}){var l;let o=w((l=e.selectedIndex)!=null?l:e.defaultIndex),t=w([]),f=w([]),u=k(()=>e.selectedIndex!==null),i=k(()=>u.value?e.selectedIndex:o.value);function b(a){var s;let c=U(m.tabs.value,h),p=U(m.panels.value,h),g=c.filter(A=>{var C;return!((C=h(A))!=null&&C.hasAttribute("disabled"))});if(a<0||a>c.length-1){let A=W(o.value===null?0:Math.sign(a-o.value),{[-1]:()=>1,0:()=>W(Math.sign(a),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),C=W(A,{0:()=>c.indexOf(g[0]),1:()=>c.indexOf(g[g.length-1])});C!==-1&&(o.value=C),m.tabs.value=c,m.panels.value=p}else{let A=c.slice(0,a),C=[...c.slice(a),...A].find(V=>g.includes(V));if(!C)return;let F=(s=c.indexOf(C))!=null?s:m.selectedIndex.value;F===-1&&(F=m.selectedIndex.value),o.value=F,m.tabs.value=c,m.panels.value=p}}let m={selectedIndex:k(()=>{var a,s;return(s=(a=o.value)!=null?a:e.defaultIndex)!=null?s:null}),orientation:k(()=>e.vertical?"vertical":"horizontal"),activation:k(()=>e.manual?"manual":"auto"),tabs:t,panels:f,setSelectedIndex(a){i.value!==a&&v("change",a),u.value||b(a)},registerTab(a){var s;if(t.value.includes(a))return;let c=t.value[o.value];t.value.push(a),t.value=U(t.value,h);let p=(s=t.value.indexOf(c))!=null?s:o.value;p!==-1&&(o.value=p)},unregisterTab(a){let s=t.value.indexOf(a);s!==-1&&t.value.splice(s,1)},registerPanel(a){f.value.includes(a)||(f.value.push(a),f.value=U(f.value,h))},unregisterPanel(a){let s=f.value.indexOf(a);s!==-1&&f.value.splice(s,1)}};ee($e,m);let S=w({tabs:[],panels:[]}),N=w(!1);R(()=>{N.value=!0}),ee(Z,k(()=>N.value?null:S.value));let L=k(()=>e.selectedIndex);return R(()=>{_e([L],()=>{var a;return b((a=e.selectedIndex)!=null?a:e.defaultIndex)},{immediate:!0})}),me(()=>{if(!u.value||i.value==null||m.tabs.value.length<=0)return;let a=U(m.tabs.value,h);a.some((s,c)=>h(m.tabs.value[c])!==h(s))&&m.setSelectedIndex(a.findIndex(s=>h(s)===h(m.tabs.value[i.value])))}),()=>{let a={selectedIndex:o.value};return z(M,[t.value.length<=0&&z(Ee,{onFocus:()=>{for(let s of t.value){let c=h(s);if((c==null?void 0:c.tabIndex)===0)return c.focus(),!0}return!1}}),K({theirProps:{...r,...Ae(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:a,slots:d,attrs:r,name:"TabGroup"})])}}}),Oe=O({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:d,slots:r}){let v=Q("TabList");return()=>{let l={selectedIndex:v.selectedIndex.value},o={role:"tablist","aria-orientation":v.orientation.value};return K({ourProps:o,theirProps:e,slot:l,attrs:d,slots:r,name:"TabList"})}}}),be=O({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-tabs-tab-${xe()}`}},setup(e,{attrs:d,slots:r,expose:v}){let l=Q("Tab"),o=w(null);v({el:o,$el:o}),R(()=>l.registerTab(o)),he(()=>l.unregisterTab(o));let t=X(Z),f=k(()=>{if(t.value){let s=t.value.tabs.indexOf(e.id);return s===-1?t.value.tabs.push(e.id)-1:s}return-1}),u=k(()=>{let s=l.tabs.value.indexOf(o);return s===-1?f.value:s}),i=k(()=>u.value===l.selectedIndex.value);function b(s){var c;let p=s();if(p===Y.Success&&l.activation.value==="auto"){let g=(c=Se(o))==null?void 0:c.activeElement,A=l.tabs.value.findIndex(C=>h(C)===g);A!==-1&&l.setSelectedIndex(A)}return p}function m(s){let c=l.tabs.value.map(p=>h(p)).filter(Boolean);if(s.key===E.Space||s.key===E.Enter){s.preventDefault(),s.stopPropagation(),l.setSelectedIndex(u.value);return}switch(s.key){case E.Home:case E.PageUp:return s.preventDefault(),s.stopPropagation(),b(()=>j(c,I.First));case E.End:case E.PageDown:return s.preventDefault(),s.stopPropagation(),b(()=>j(c,I.Last))}if(b(()=>W(l.orientation.value,{vertical(){return s.key===E.ArrowUp?j(c,I.Previous|I.WrapAround):s.key===E.ArrowDown?j(c,I.Next|I.WrapAround):Y.Error},horizontal(){return s.key===E.ArrowLeft?j(c,I.Previous|I.WrapAround):s.key===E.ArrowRight?j(c,I.Next|I.WrapAround):Y.Error}}))===Y.Success)return s.preventDefault()}let S=w(!1);function N(){var s;S.value||(S.value=!0,!e.disabled&&((s=h(o))==null||s.focus({preventScroll:!0}),l.setSelectedIndex(u.value),ke(()=>{S.value=!1})))}function L(s){s.preventDefault()}let a=Pe(k(()=>({as:e.as,type:d.type})),o);return()=>{var s;let c={selected:i.value},{id:p,...g}=e,A={ref:o,onKeydown:m,onMousedown:L,onClick:N,id:p,role:"tab",type:a.value,"aria-controls":(s=h(l.panels.value[u.value]))==null?void 0:s.id,"aria-selected":i.value,tabIndex:i.value?0:-1,disabled:e.disabled?!0:void 0};return K({ourProps:A,theirProps:g,slot:c,attrs:d,slots:r,name:"Tab"})}}}),H=O({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-tabs-panel-${xe()}`},tabIndex:{type:Number,default:0}},setup(e,{attrs:d,slots:r,expose:v}){let l=Q("TabPanel"),o=w(null);v({el:o,$el:o}),R(()=>l.registerPanel(o)),he(()=>l.unregisterPanel(o));let t=X(Z),f=k(()=>{if(t.value){let b=t.value.panels.indexOf(e.id);return b===-1?t.value.panels.push(e.id)-1:b}return-1}),u=k(()=>{let b=l.panels.value.indexOf(o);return b===-1?f.value:b}),i=k(()=>u.value===l.selectedIndex.value);return()=>{var b;let m={selected:i.value},{id:S,tabIndex:N,...L}=e,a={ref:o,id:S,role:"tabpanel","aria-labelledby":(b=h(l.tabs.value[u.value]))==null?void 0:b.id,tabIndex:i.value?N:-1};return!i.value&&e.unmount&&!e.static?z(ge,{as:"span",...a}):K({ourProps:a,theirProps:L,slot:m,attrs:d,slots:r,features:te.Static|te.RenderStrategy,visible:i.value,name:"TabPanel"})}}});const Ne={class:"grid grid-flow-col space-x-4"},De={class:"w-full h-48 object-cover rounded-lg"},je={class:"text-xl font-semibold mb-2"},Re={class:"text-sm mb-2"},Fe=n("strong",null,"Id:",-1),Ue={class:"text-sm mb-2"},qe=n("strong",null,"Variety:",-1),Ge={class:"text-sm mb-2"},Me=n("strong",null,"Yield Tonnage:",-1),Ve={class:"text-sm mb-2"},Ye=n("strong",null,"Expected Harvest Date:",-1),He={class:"text-sm mb-2"},We=n("strong",null,"Price:",-1),ze={class:"flex justify-end mt-2 space-x-4"},Ke=["onClick"],Je=["disabled","onClick"],Qe=O({__name:"SellerContentComponent",props:{ads:{type:Array,required:!0}},emits:["post","remove","edit"],setup(e,{emit:d}){const r=d,v=f=>{f&&r("post",f)},l=w(""),o=async f=>{f&&(l.value=f,console.log("removeAd",f),await D().removeUserAd(f),l.value="")},t=f=>{f&&r("edit",f)};return(f,u)=>(_(),y("span",Ne,[(_(!0),y(M,null,J(e.ads,(i,b)=>(_(),y("div",{key:b,class:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300"},[n("div",De,[P(Ce,{images:i.resizedImages},null,8,["images"])]),n("h3",je,$(i.type),1),n("p",Re,[Fe,T(" "+$(i.id),1)]),n("p",Ue,[qe,T(" "+$(i.variety),1)]),n("p",Ge,[Me,T(" "+$(i.yieldTonnage),1)]),n("p",Ve,[Ye,T(" "+$(i.expectedHarvestDate),1)]),n("p",He,[We,T(" "+$(i.price),1)]),n("div",ze,[n("button",{onClick:m=>t(i.id),class:"inline-flex justify-center rounded-md border border-transparent bg-green-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"}," Edit ",8,Ke),n("button",{disabled:i.live,onClick:m=>v(i.id),class:"inline-flex justify-center rounded-md border border-transparent bg-green-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"}," Post ",8,Je),P(ye,{disabled:i.live,isLoading:l.value==i.id,onClick:m=>o(i.id),class:"inline-flex justify-center rounded-md border border-transparent bg-red-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},{default:B(()=>[T(" Remove ")]),_:2},1032,["disabled","isLoading","onClick"])])]))),128))]))}}),Xe={class:"text-xl font-semibold mb-2"},Ze={class:"text-sm mb-2"},et=n("strong",null,"Id:",-1),tt={class:"text-sm mb-2"},st=n("strong",null,"Yield Tonnage:",-1),nt={class:"text-sm mb-2"},lt=n("strong",null,"Request Date:",-1),ot={class:"text-sm mb-2"},at=n("strong",null,"Price:",-1),rt={class:"flex justify-end mt-2 space-x-4"},it=["onClick"],ut=["disabled","onClick"],dt=["disabled","onClick"],ct=O({__name:"BuyerContentComponent",props:{ads:{type:Array,required:!0}},emits:["post","remove","edit"],setup(e,{emit:d}){const r=d,v=t=>{t&&r("post",t)},l=t=>{t&&r("remove",t)},o=t=>{t&&r("edit",t)};return(t,f)=>(_(),y("span",null,[(_(!0),y(M,null,J(e.ads,(u,i)=>(_(),y("div",{key:i,class:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300"},[n("h3",Xe,$(u.type),1),n("p",Ze,[et,T(" "+$(u.id),1)]),n("p",tt,[st,T(" "+$(u.yieldTonnage),1)]),n("p",nt,[lt,T(" "+$(u.requestDate),1)]),n("p",ot,[at,T(" "+$(u.price),1)]),n("div",rt,[n("button",{onClick:b=>o(u.id),class:"inline-flex justify-center rounded-md border border-transparent bg-green-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"}," Edit ",8,it),n("button",{disabled:u.live,onClick:b=>v(u.id),class:"inline-flex justify-center rounded-md border border-transparent bg-green-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"}," Post ",8,ut),n("button",{disabled:!u.live,onClick:b=>l(u.id),class:"inline-flex justify-center rounded-md border border-transparent bg-red-100 px-4 py-2 text-sm font-medium text-green-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"}," Remove ",8,dt)])]))),128))]))}}),vt={class:"grid grid-flow-row space-y-4"},ft={class:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 mb-4"},pt={class:"flex flex-row"},bt={class:"flex flex-row space-x-4"},mt=n("label",{class:"block text-sm font-medium text-gray-700"},"Buyer",-1),gt={class:"text-sm"},_t={class:"flex flex-row space-x-4"},xt=n("label",{class:"block text-sm font-medium text-gray-700"},"Offer",-1),ht={class:"text-sm"},yt={class:"flex flex-row space-x-4"},$t=n("label",{class:"block text-sm font-medium text-gray-700"},"Time",-1),wt={class:"text-sm"},At={class:"flex flex-row space-x-4"},kt=n("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1),St={class:"text-sm"},Tt={class:"flex flex-row space-x-4"},Ct=n("label",{class:"block text-sm font-medium text-gray-700"},"Last updated",-1),Pt={class:"text-sm"},Et={class:"flex justify-end"},It=O({__name:"BidContentComponent",props:{bids:{type:Array,required:!0}},setup(e){const d=D().BID_STATUSES,r=w(""),v=async l=>{console.log("Cancelling bid",l),r.value=l,await D().cancelUserBid(l),r.value=""};return(l,o)=>(_(),y("span",vt,[(_(!0),y(M,null,J(e.bids,t=>(_(),y("div",ft,[n("div",pt,[n("span",null,[n("div",bt,[mt,n("p",gt,$(t.buyerId.substring(0,5)),1)]),n("div",_t,[xt,n("p",ht,$(t.price),1)]),n("div",yt,[$t,n("p",wt,$(x(se)(t.createdAt)?x(ne)(t.createdAt):t.createdAt),1)])]),n("span",null,[n("div",At,[kt,n("p",St,$(t.status),1)]),n("div",Tt,[Ct,n("p",Pt,$(x(se)(t.updatedAt)?x(ne)(t.updatedAt):t.updatedAt),1)])])]),n("div",Et,[t.status===x(d).PENDING?(_(),q(ye,{key:0,isLoading:r.value==t.id,onClick:f=>v(t.id),class:"mt-2 mb-2 inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},{default:B(()=>[T("Cancel Bid")]),_:2},1032,["isLoading","onClick"])):G("",!0)])]))),256))]))}}),Bt={class:"w-full px-2 py-3 sm:px-0"},Lt={key:0,class:"w-full"},Ot={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Nt={key:1},Dt={key:2},jt=n("div",null,"No ads found",-1),Rt=[jt],Ft={key:1},Ut={key:2},qt=n("p",null,"No bids yet",-1),Gt=[qt],Yt=O({__name:"UserBoardView",setup(e){const{profile:d,user:r}=le(D()),{modals:v}=le(Te()),l=D().ACCOUNT_TYPES,o=()=>{v.value.addad=!0},t=w(0),f={ADS:"Ads",CONTRACTS:"Contracts",MESSAGES:"Messages"},u=w([]),i=w([]),b=w(!1),m=async()=>{b.value=!0,u.value=await oe("ads","uid","==",r.value.uid,["createdAt","desc"],10),console.log("ads",u.value),L=ae(re(de(fe,"ads"),ue("uid","==",r.value.uid),ie("createdAt","desc")),p=>{u.value.docs=p.docs.map(g=>(console.log("ads changed"),{id:g.id,...g.data()}))}),b.value=!1},S=w(!1),N=async()=>{S.value=!0,i.value=await oe("bids","buyerId","==",r.value.uid,["createdAt","desc"],10),console.log("loadingBids",i.value),L=ae(re(de(fe,"bids"),ue("buyerId","==",r.value.uid),ie("createdAt","desc")),p=>{i.value.docs=p.docs.map(g=>(console.log("bids changed"),{id:g.id,...g.data()}))}),S.value=!1};let L;_e(t,async(p,g)=>{t.value==0&&await m(),t.value==3&&await N(),(g==3||g==0)&&L()}),R(async()=>{console.log("mounted"),await m()});const a=async p=>{console.log("postAd",p),await D().postNewAd(p)},s=async p=>{console.log("removeAd",p),await D().removeUserAd(p)},c=async p=>{console.log("removeAd",p),v.value.editad=!0,v.value.context=u.value.docs.find(g=>g.id===p)};return(p,g)=>(_(),y("div",Bt,[x(d)?(_(),y("div",Lt,[P(x(Le),{class:"w-full",as:"div"},{default:B(()=>[P(x(Oe),{class:"w-full flex space-x-1 rounded-xl bg-blue-900/20 p-1"},{default:B(()=>[(_(),y(M,null,J(f,(A,C,F)=>P(x(be),{as:"template",key:C,onClick:V=>t.value=F},{default:B(({selected:V})=>[n("button",{class:ce(["w-full rounded-lg py-2.5 text-sm font-medium leading-5 text-blue-700","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2",V?"bg-white shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"])},$(A),3)]),_:2},1032,["onClick"])),64)),x(d).accountType===x(l).BUYER?(_(),q(x(be),{key:0,as:"template",onClick:g[0]||(g[0]=A=>t.value=3)},{default:B(({selected:A})=>[n("button",{class:ce(["w-full rounded-lg py-2.5 text-sm font-medium leading-5 text-blue-700","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2",A?"bg-white shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"])}," Bids ",2)]),_:1})):G("",!0)]),_:1}),P(x(H),null,{default:B(()=>[n("button",{onClick:o,class:"mt-2 mb-2 w-full inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},"Add an ad"),u.value.docs&&u.value.docs.length>0&&!b.value?(_(),y("div",Ot,[x(d).accountType==x(l).SELLER?(_(),q(Qe,{key:0,ads:u.value.docs?u.value.docs:[],onPost:a,onEdit:c},null,8,["ads"])):G("",!0),x(d).accountType==x(l).BUYER?(_(),q(ct,{key:1,ads:u.value.docs?u.value.docs:[],onPost:a,onRemove:s,onEdit:c},null,8,["ads"])):G("",!0)])):b.value?(_(),y("div",Nt,[P(ve,{isLoading:b.value},null,8,["isLoading"])])):(_(),y("div",Dt,Rt))]),_:1}),P(x(H),null,{default:B(()=>[T(" Contract ")]),_:1}),P(x(H),null,{default:B(()=>[T(" Messages ")]),_:1}),P(x(H),null,{default:B(()=>[i.value.docs&&i.value.docs.length>0&&!S.value?(_(),q(It,{key:0,bids:i.value.docs?i.value.docs:[]},null,8,["bids"])):S.value?(_(),y("div",Ft,[P(ve,{isLoading:S.value},null,8,["isLoading"])])):(_(),y("span",Ut,Gt))]),_:1})]),_:1})])):G("",!0)]))}});export{Yt as default};
