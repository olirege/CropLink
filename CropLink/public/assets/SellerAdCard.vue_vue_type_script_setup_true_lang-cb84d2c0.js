import{I as U}from"./ImageCarousel-67a385db.js";import{d as _,s as q,n as L,a as G,u as W,r as v,G as Y,o as Q,e as o,f as u,k as t,t as l,p as S,C as r,A as c,L as J,B as f,F as K,q as y,x as k,y as N,j as m,a5 as X,a1 as O,a3 as R,z as B}from"./index-d604ebf2.js";import{r as Z}from"./CheckCircleIcon-f8e1ea61.js";const ee={class:"bg-white p-4 rounded-xl shadow transition-shadow duration-300 hover:shadow-xl"},te={key:0},se={class:"flex flex-row gap-2 items-end mb-2 bg-gradient-to-r from-sky-500/50 to-white rounded-md"},ae=["src"],oe={class:"flex flex-col"},ne={key:0,class:"flex flex-row gap-1"},de=t("p",{class:"text-xs italic"},[t("span",{class:"text-sky-500 font-bold"},"v"),m("erified")],-1),ie={class:"text-xs italic"},le={key:1,class:"w-full flex items-center justify-center h-24"},re={class:"text-xl font-semibold mb-2 capitalize"},ue={class:"w-full h-96 object-cover rounded-lg"},ce={key:1,class:"flex items-center justify-center h-full"},me=t("p",{class:"text-gray-500"},"No Image Available",-1),ve=[me],fe={class:"overflow-hidden rounded-lg shadow-md mt-4"},ye={class:"min-w-full"},ge=t("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Type:",-1),xe={class:"border px-4 py-2 text-sm"},he=t("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Variety:",-1),be={class:"border px-4 py-2 text-sm"},we=t("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Price per Ton:",-1),Se={class:"border px-4 py-2 text-sm"},ke=t("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Quantity:",-1),Te={class:"border px-4 py-2 text-sm"},Ce=t("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Expected Harvest Date:",-1),pe={class:"border px-4 py-2 text-sm"},Ae=t("td",{class:"border px-4 py-2 text-sm font-medium bg-slate-100"},"Bidding End Time:",-1),Ee={class:"border px-4 py-2 text-sm"},De={key:1},$e={colspan:"2",class:"border px-4 py-2 text-sm font-medium"},Le={key:2,class:"flex items-center justify-end mt-2 space-x-4"},Fe=_({__name:"SellerAdCard",props:{ad:{type:Object,required:!0},showButtons:{type:Boolean,default:!0}},emits:["edit"],setup(e,{emit:Ne}){const{modals:T,notifications:n}=q(L()),g=L().NOTIFICATION_TYPES,x=G().AD_STATUSES,b=W(),F=e,C=v(!1),p=v(!1),j=async a=>{if(!a)return;const{callFunction:s}=B("postAd",{adId:a},p,void 0,void 0,()=>{n.value.show=!0,n.value.type=g.SUCCESS,n.value.message="Ad is live!"},i=>{n.value.show=!0,n.value.type=g.ERROR,n.value.message="Error while posting ad, please try again later"});await s()},A=v(!0),M=async a=>{if(!a)return;const{callFunction:s}=B("removeAd",{adId:a},A,void 0,void 0,()=>{n.value.show=!0,n.value.type=g.SUCCESS,n.value.message="Ad removed!"},i=>{n.value.show=!0,n.value.type=g.ERROR,n.value.message="Error while removing ad, please try again later"});await s()},P=a=>{a&&b.push({name:"ad",params:{adId:a}})},V=async a=>{a&&(console.log("removeAd",a),T.value.editad=!0,T.value.context=ads.value.docs.find(s=>s.id===a))},I=a=>{a&&b.push({name:"messaging",params:{adId:a}})},d=v(null),h=v(!1),z=async a=>{a&&(h.value=!0,d.value=await X("ads",a),h.value=!1)},H=Y(()=>{if(!d.value)return;const a=new Date,s=new Date(d.value.createdAt.toDate().toString()),i=a.getTime()-s.getTime(),D=Math.floor(i/(1e3*60*60*24)),w=Math.floor(D/31),$=Math.floor(w/12);return $>0?`${$} yrs`:w>0?`${w} mths`:`${D} days`}),E=(a,s)=>{console.log("go to seller ads",a),b.push({name:"seller-ads",params:{id:a,sellerName:s}})};return Q(async()=>{await z(F.ad.uid)}),(a,s)=>(o(),u("div",ee,[!h.value&&d.value?(o(),u("div",te,[t("span",se,[t("img",{src:d.value.storeLogoResized,class:"w-10 h-10 rounded-md object-cover bg-slate-500 cursor-pointer",onClick:s[0]||(s[0]=i=>E(d.value.id,d.value.companyName))},null,8,ae),t("span",oe,[t("h1",{class:"text-md font-bold capitalize cursor-pointer",onClick:s[1]||(s[1]=i=>E(d.value.id,d.value.companyName))},l(`${d.value.companyName}`),1),d.value.verifiedSeller?(o(),u("div",ne,[S(r(Z),{class:"h-4 w-4 text-sky-500"}),de,t("p",ie,l(H.value),1)])):c("",!0)])])])):(o(),u("div",le,[S(J,{isLoading:h.value},null,8,["isLoading"])])),t("h3",re,l(`${e.ad.variety}`),1),t("div",ue,[e.ad.images&&e.ad.images.length>0?(o(),f(U,{key:0,images:e.ad.resizedImages,classes:"h-96"},null,8,["images"])):(o(),u("div",ce,ve))]),t("div",fe,[t("table",ye,[t("tbody",null,[t("tr",null,[ge,t("td",xe,l(e.ad.type),1)]),t("tr",null,[he,t("td",be,l(e.ad.variety),1)]),t("tr",null,[we,t("td",Se,l(e.ad.pricePerTon),1)]),t("tr",null,[ke,t("td",Te,l(e.ad.tons),1)]),C.value?(o(),u(K,{key:0},[t("tr",null,[Ce,t("td",pe,l(r(O)(e.ad.expectedHarvestDate)?r(R)(e.ad.expectedHarvestDate):e.ad.expectedHarvestDate),1)]),t("tr",null,[Ae,t("td",Ee,l(r(O)(e.ad.biddingEndTime)?r(R)(e.ad.biddingEndTime):e.ad.biddingEndTime),1)])],64)):(o(),u("tr",De,[t("td",$e,[t("button",{class:"text-sky-500 hover:underline",onClick:s[2]||(s[2]=i=>C.value=!0)},"Show More")])]))])])]),e.showButtons?(o(),u("div",Le,[!e.ad.live&&e.ad.status!=r(x).SOLD?(o(),f(k,{key:0,onClick:s[3]||(s[3]=i=>V(e.ad.id))},{default:y(()=>[m(" Edit ")]),_:1})):c("",!0),!e.ad.live&&e.ad.status==r(x).SOLD?(o(),f(k,{key:1,classes:"truncate",onClick:s[4]||(s[4]=i=>I(e.ad.id))},{default:y(()=>[m(" Contact Winner ")]),_:1})):c("",!0),!e.ad.live&&e.ad.status!=r(x).SOLD?(o(),f(N,{key:2,disabled:e.ad.live,isLoading:p.value,onClick:s[5]||(s[5]=i=>j(e.ad.id))},{default:y(()=>[m(" Post "+l(e.ad.status),1)]),_:1},8,["disabled","isLoading"])):c("",!0),S(k,{onClick:s[6]||(s[6]=i=>P(e.ad.id))},{default:y(()=>[m(" View ")]),_:1}),!e.ad.live&&e.ad.status!=r(x).SOLD?(o(),f(N,{key:3,disabled:e.ad.live,isLoading:A.value==e.ad.id,onClick:s[7]||(s[7]=i=>M(e.ad.id))},{default:y(()=>[m(" Remove ")]),_:1},8,["disabled","isLoading"])):c("",!0)])):c("",!0)]))}});export{Fe as _};
