import{h as y,o as G,O as fe,P as g,d as k,Q as K,R as Ae,S as me,T as $,U,V as te,W as be,X as J,Y as Ie,F as q,Z as _e,$ as he,a0 as X,a1 as ae,a2 as H,a3 as L,a4 as j,a5 as ke,a6 as Ce,a7 as D,a8 as O,e as n,f as p,k as M,q as E,g as d,t as N,y as x,a9 as xe,N as ge,s as se,a as le,x as Se,l as B,m as F,p as W,aa as V,z as ne,I as oe,J as re,K as ue,M as de,ab as ce,L as Y,B as ie}from"./index-aa4b1524.js";import{_ as Te}from"./SellerAdCard.vue_vue_type_script_setup_true_lang-d2976f19.js";import{_ as Pe}from"./BuyerAdCard.vue_vue_type_script_setup_true_lang-dd6a6f54.js";import{_ as Be}from"./BidCard.vue_vue_type_script_setup_true_lang-abe72ac3.js";function ve(e,r){if(e)return e;let s=r??"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function Ee(e,r){let s=y(ve(e.value.type,e.value.as));return G(()=>{s.value=ve(e.value.type,e.value.as)}),fe(()=>{var i;s.value||g(r)&&g(r)instanceof HTMLButtonElement&&!((i=g(r))!=null&&i.hasAttribute("type"))&&(s.value="button")}),s}let Le=k({props:{onFocus:{type:Function,required:!0}},setup(e){let r=y(!0);return()=>r.value?K(me,{as:"button",type:"button",features:Ae.Focusable,onFocus(s){s.preventDefault();let i,l=50;function o(){var c;if(l--<=0){i&&cancelAnimationFrame(i);return}if((c=e.onFocus)!=null&&c.call(e)){r.value=!1,cancelAnimationFrame(i);return}i=requestAnimationFrame(o)}i=requestAnimationFrame(o)}}):null}});var Oe=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Oe||{}),Ne=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Ne||{});let ye=Symbol("TabsContext");function Q(e){let r=X(ye,null);if(r===null){let s=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Q),s}return r}let Z=Symbol("TabsSSRContext"),Fe=k({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:r,attrs:s,emit:i}){var l;let o=y((l=e.selectedIndex)!=null?l:e.defaultIndex),c=y([]),A=y([]),b=$(()=>e.selectedIndex!==null),h=$(()=>b.value?e.selectedIndex:o.value);function f(a){var t;let u=U(v.tabs.value,g),w=U(v.panels.value,g),P=u.filter(S=>{var m;return!((m=g(S))!=null&&m.hasAttribute("disabled"))});if(a<0||a>u.length-1){let S=H(o.value===null?0:Math.sign(a-o.value),{[-1]:()=>1,0:()=>H(Math.sign(a),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),m=H(S,{0:()=>u.indexOf(P[0]),1:()=>u.indexOf(P[P.length-1])});m!==-1&&(o.value=m),v.tabs.value=u,v.panels.value=w}else{let S=u.slice(0,a),m=[...u.slice(a),...S].find(R=>P.includes(R));if(!m)return;let _=(t=u.indexOf(m))!=null?t:v.selectedIndex.value;_===-1&&(_=v.selectedIndex.value),o.value=_,v.tabs.value=u,v.panels.value=w}}let v={selectedIndex:$(()=>{var a,t;return(t=(a=o.value)!=null?a:e.defaultIndex)!=null?t:null}),orientation:$(()=>e.vertical?"vertical":"horizontal"),activation:$(()=>e.manual?"manual":"auto"),tabs:c,panels:A,setSelectedIndex(a){h.value!==a&&i("change",a),b.value||f(a)},registerTab(a){var t;if(c.value.includes(a))return;let u=c.value[o.value];c.value.push(a),c.value=U(c.value,g);let w=(t=c.value.indexOf(u))!=null?t:o.value;w!==-1&&(o.value=w)},unregisterTab(a){let t=c.value.indexOf(a);t!==-1&&c.value.splice(t,1)},registerPanel(a){A.value.includes(a)||(A.value.push(a),A.value=U(A.value,g))},unregisterPanel(a){let t=A.value.indexOf(a);t!==-1&&A.value.splice(t,1)}};te(ye,v);let I=y({tabs:[],panels:[]}),C=y(!1);G(()=>{C.value=!0}),te(Z,$(()=>C.value?null:I.value));let T=$(()=>e.selectedIndex);return G(()=>{be([T],()=>{var a;return f((a=e.selectedIndex)!=null?a:e.defaultIndex)},{immediate:!0})}),fe(()=>{if(!b.value||h.value==null||v.tabs.value.length<=0)return;let a=U(v.tabs.value,g);a.some((t,u)=>g(v.tabs.value[u])!==g(t))&&v.setSelectedIndex(a.findIndex(t=>g(t)===g(v.tabs.value[h.value])))}),()=>{let a={selectedIndex:o.value};return K(q,[c.value.length<=0&&K(Le,{onFocus:()=>{for(let t of c.value){let u=g(t);if((u==null?void 0:u.tabIndex)===0)return u.focus(),!0}return!1}}),J({theirProps:{...s,...Ie(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:a,slots:r,attrs:s,name:"TabGroup"})])}}}),qe=k({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:r,slots:s}){let i=Q("TabList");return()=>{let l={selectedIndex:i.selectedIndex.value},o={role:"tablist","aria-orientation":i.orientation.value};return J({ourProps:o,theirProps:e,slot:l,attrs:r,slots:s,name:"TabList"})}}}),pe=k({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-tabs-tab-${_e()}`}},setup(e,{attrs:r,slots:s,expose:i}){let l=Q("Tab"),o=y(null);i({el:o,$el:o}),G(()=>l.registerTab(o)),he(()=>l.unregisterTab(o));let c=X(Z),A=$(()=>{if(c.value){let t=c.value.tabs.indexOf(e.id);return t===-1?c.value.tabs.push(e.id)-1:t}return-1}),b=$(()=>{let t=l.tabs.value.indexOf(o);return t===-1?A.value:t}),h=$(()=>b.value===l.selectedIndex.value);function f(t){var u;let w=t();if(w===j.Success&&l.activation.value==="auto"){let P=(u=Ce(o))==null?void 0:u.activeElement,S=l.tabs.value.findIndex(m=>g(m)===P);S!==-1&&l.setSelectedIndex(S)}return w}function v(t){let u=l.tabs.value.map(w=>g(w)).filter(Boolean);if(t.key===L.Space||t.key===L.Enter){t.preventDefault(),t.stopPropagation(),l.setSelectedIndex(b.value);return}switch(t.key){case L.Home:case L.PageUp:return t.preventDefault(),t.stopPropagation(),f(()=>D(u,O.First));case L.End:case L.PageDown:return t.preventDefault(),t.stopPropagation(),f(()=>D(u,O.Last))}if(f(()=>H(l.orientation.value,{vertical(){return t.key===L.ArrowUp?D(u,O.Previous|O.WrapAround):t.key===L.ArrowDown?D(u,O.Next|O.WrapAround):j.Error},horizontal(){return t.key===L.ArrowLeft?D(u,O.Previous|O.WrapAround):t.key===L.ArrowRight?D(u,O.Next|O.WrapAround):j.Error}}))===j.Success)return t.preventDefault()}let I=y(!1);function C(){var t;I.value||(I.value=!0,!e.disabled&&((t=g(o))==null||t.focus({preventScroll:!0}),l.setSelectedIndex(b.value),ke(()=>{I.value=!1})))}function T(t){t.preventDefault()}let a=Ee($(()=>({as:e.as,type:r.type})),o);return()=>{var t;let u={selected:h.value},{id:w,...P}=e,S={ref:o,onKeydown:v,onMousedown:T,onClick:C,id:w,role:"tab",type:a.value,"aria-controls":(t=g(l.panels.value[b.value]))==null?void 0:t.id,"aria-selected":h.value,tabIndex:h.value?0:-1,disabled:e.disabled?!0:void 0};return J({ourProps:S,theirProps:P,slot:u,attrs:r,slots:s,name:"Tab"})}}}),z=k({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-tabs-panel-${_e()}`},tabIndex:{type:Number,default:0}},setup(e,{attrs:r,slots:s,expose:i}){let l=Q("TabPanel"),o=y(null);i({el:o,$el:o}),G(()=>l.registerPanel(o)),he(()=>l.unregisterPanel(o));let c=X(Z),A=$(()=>{if(c.value){let f=c.value.panels.indexOf(e.id);return f===-1?c.value.panels.push(e.id)-1:f}return-1}),b=$(()=>{let f=l.panels.value.indexOf(o);return f===-1?A.value:f}),h=$(()=>b.value===l.selectedIndex.value);return()=>{var f;let v={selected:h.value},{id:I,tabIndex:C,...T}=e,a={ref:o,id:I,role:"tabpanel","aria-labelledby":(f=g(l.tabs.value[b.value]))==null?void 0:f.id,tabIndex:h.value?C:-1};return!h.value&&e.unmount&&!e.static?K(me,{as:"span",...a}):J({ourProps:a,theirProps:T,slot:v,attrs:r,slots:s,features:ae.Static|ae.RenderStrategy,visible:h.value,name:"TabPanel"})}}});const Re={class:"grid grid-flow-col space-x-4"},De=k({__name:"SellerContentComponent",props:{ads:{type:Array,required:!0}},setup(e){return(r,s)=>(n(),p("span",Re,[(n(!0),p(q,null,M(e.ads,(i,l)=>(n(),E(Te,{key:l,ad:i},null,8,["ad"]))),128))]))}}),Ve=k({__name:"BuyerContentComponent",props:{ads:{type:Array,required:!0}},setup(e){return(r,s)=>(n(),p("span",null,[(n(!0),p(q,null,M(e.ads,(i,l)=>(n(),E(Pe,{key:l,ad:i},null,8,["ad"]))),128))]))}}),Ge={class:"grid grid-flow-row space-y-4"},Me=k({__name:"BidContentComponent",props:{bids:{type:Array,required:!0}},setup(e){return(r,s)=>(n(),p("span",Ge,[(n(!0),p(q,null,M(e.bids,i=>(n(),E(Be,{bid:i},null,8,["bid"]))),256))]))}}),Ue={class:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 mb-4"},je={class:"flex flex-row space-x-4"},We=d("label",{class:"block text-sm font-medium text-gray-700"},"createdAt",-1),Ye={class:"text-sm"},ze={class:"flex flex-row space-x-4"},He=d("label",{class:"block text-sm font-medium text-gray-700"},"Ad",-1),Ke={class:"text-sm"},Je={class:"flex flex-row space-x-4"},Qe=d("label",{class:"block text-sm font-medium text-gray-700"},"buyerId",-1),Xe={class:"text-sm"},Ze={class:"flex flex-row space-x-4"},et=d("label",{class:"block text-sm font-medium text-gray-700"},"sellerId",-1),tt={class:"text-sm"},at=k({__name:"ContractCard",props:{contract:{type:Object,required:!0}},setup(e){return(r,s)=>(n(),p("span",Ue,[d("div",je,[We,d("p",Ye,N(x(xe)(e.contract.createdAt)?x(ge)(e.contract.createdAt):e.contract.createdAt),1)]),d("div",ze,[He,d("p",Ke,N(e.contract.adId.substring(0,5)),1)]),d("div",Je,[Qe,d("p",Xe,N(e.contract.buyerId.substring(0,5)),1)]),d("div",Ze,[et,d("p",tt,N(e.contract.sellerId.substring(0,5)),1)])]))}}),st={class:"grid grid-flow-row space-y-4"},lt=k({__name:"ContractsContentComponent",props:{contracts:{type:Array,required:!0}},setup(e){return(r,s)=>(n(),p("span",st,[(n(!0),p(q,null,M(e.contracts,(i,l)=>(n(),E(at,{key:l,contract:i},null,8,["contract"]))),128))]))}}),nt={class:"bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300 mb-4"},ot={class:"flex flex-row space-x-4"},rt=d("label",{class:"block text-sm font-medium text-gray-700"},"createdAt",-1),ut={class:"text-sm"},dt={class:"flex flex-row space-x-4"},ct=d("label",{class:"block text-sm font-medium text-gray-700"},"Ad",-1),it={class:"text-sm"},vt={class:"flex flex-row space-x-4"},pt=d("label",{class:"block text-sm font-medium text-gray-700"},"buyerId",-1),ft={class:"text-sm"},mt={class:"flex flex-row space-x-4"},bt=d("label",{class:"block text-sm font-medium text-gray-700"},"sellerId",-1),_t={class:"text-sm"},ht=k({__name:"ChatRoomCard",props:{chatroom:{type:Object,required:!0}},setup(e){return(r,s)=>(n(),p("span",nt,[d("div",ot,[rt,d("p",ut,N(x(xe)(e.chatroom.createdAt)?x(ge)(e.chatroom.createdAt):e.chatroom.createdAt),1)]),d("div",dt,[ct,d("p",it,N(e.chatroom.adId.substring(0,5)),1)]),d("div",vt,[pt,d("p",ft,N(e.chatroom.buyerId.substring(0,5)),1)]),d("div",mt,[bt,d("p",_t,N(e.chatroom.sellerId.substring(0,5)),1)])]))}}),xt={class:"grid grid-flow-row space-y-4"},gt=k({__name:"ChatRoomsContentComponent",props:{chatrooms:{type:Array,required:!0}},setup(e){return(r,s)=>(n(),p("span",xt,[(n(!0),p(q,null,M(e.chatrooms,(i,l)=>(n(),E(ht,{key:l,chatroom:i},null,8,["chatroom"]))),128))]))}}),yt={class:"w-full px-2 py-3 sm:px-0"},wt={key:0,class:"w-full"},$t={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},At={key:1},It={key:2},kt=d("div",null,"No ads found",-1),Ct=[kt],St={key:1},Tt={key:2},Pt=d("p",null,"No contracts yet",-1),Bt=[Pt],Et={key:1},Lt={key:2},Ot=d("p",null,"No conversations yet",-1),Nt=[Ot],Ft={key:1},qt={key:2},Rt=d("p",null,"No bids yet",-1),Dt=[Rt],jt=k({__name:"UserBoardView",setup(e){const{profile:r,user:s}=se(le()),{modals:i}=se(Se()),l=le().ACCOUNT_TYPES,o=()=>{i.value.addad=!0},c=y(0),A={ADS:"Ads",CONTRACTS:"Contracts",MESSAGES:"Messages"},b=y([]),h=y([]),f=y([]),v=y([]),I=y(!1),C=y(!1),T=y(!1),a=y(!1);let t;const u=async()=>{T.value=!0;const m=await V("chatrooms","sellerId","==",s.value.uid,["createdAt","desc"],10),_=await V("chatrooms","buyerId","==",s.value.uid,["createdAt","desc"],10);v.value.docs=[...m.docs,..._.docs],v.value.lastVisible=[m.lastVisible,_.lastVisible],T.value=!1},w=async()=>{C.value=!0;const m=await V("contracts","sellerId","==",s.value.uid,["createdAt","desc"],10),_=await V("contracts","buyerId","==",s.value.uid,["createdAt","desc"],10);f.value.docs=[...m.docs,..._.docs],f.value.lastVisible=[m.lastVisible,_.lastVisible],C.value=!1},P=async()=>{I.value=!0,b.value=await V("ads","uid","==",s.value.uid,["createdAt","desc"],10),console.log("ads",b.value),t=ne(oe(de(ie,"ads"),ue("uid","==",s.value.uid),re("createdAt","desc")),m=>{b.value.docs=m.docs.map(_=>(console.log("ads changed"),{id:_.id,..._.data()}))}),I.value=!1},S=async()=>{a.value=!0,h.value=await V("bids","buyerId","==",s.value.uid,["createdAt","desc"],10),console.log("loadingBids",h.value),t=ne(oe(de(ie,"bids"),ue("buyerId","==",s.value.uid),re("createdAt","desc")),m=>{h.value.docs=m.docs.map(_=>(console.log("bids changed"),{id:_.id,..._.data()}))}),a.value=!1};return be(c,async(m,_)=>{c.value==0&&await P(),c.value==1&&await w(),c.value==2&&await u(),c.value==3&&await S(),(_==3||_==0)&&t()}),G(async()=>{console.log("mounted"),await P()}),(m,_)=>(n(),p("div",yt,[x(r)?(n(),p("div",wt,[B(x(Fe),{class:"w-full",as:"div"},{default:F(()=>[B(x(qe),{class:"w-full flex space-x-1 rounded-xl bg-blue-900/20 p-1"},{default:F(()=>[(n(),p(q,null,M(A,(R,we,$e)=>B(x(pe),{as:"template",key:we,onClick:ee=>c.value=$e},{default:F(({selected:ee})=>[d("button",{class:ce(["w-full rounded-lg py-2.5 text-sm font-medium leading-5 text-blue-700","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2",ee?"bg-white shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"])},N(R),3)]),_:2},1032,["onClick"])),64)),x(r).accountType===x(l).BUYER?(n(),E(x(pe),{key:0,as:"template",onClick:_[0]||(_[0]=R=>c.value=3)},{default:F(({selected:R})=>[d("button",{class:ce(["w-full rounded-lg py-2.5 text-sm font-medium leading-5 text-blue-700","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none focus:ring-2",R?"bg-white shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"])}," Bids ",2)]),_:1})):W("",!0)]),_:1}),B(x(z),null,{default:F(()=>[d("button",{onClick:o,class:"mt-2 mb-2 w-full inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"},"Add an ad"),b.value.docs&&b.value.docs.length>0&&!I.value?(n(),p("div",$t,[x(r).accountType==x(l).SELLER?(n(),E(De,{key:0,ads:b.value.docs?b.value.docs:[]},null,8,["ads"])):W("",!0),x(r).accountType==x(l).BUYER?(n(),E(Ve,{key:1,ads:b.value.docs?b.value.docs:[]},null,8,["ads"])):W("",!0)])):I.value?(n(),p("div",At,[B(Y,{isLoading:I.value},null,8,["isLoading"])])):(n(),p("div",It,Ct))]),_:1}),B(x(z),null,{default:F(()=>[f.value.docs&&f.value.docs.length>0&&!C.value?(n(),E(lt,{key:0,contracts:f.value.docs?f.value.docs:[]},null,8,["contracts"])):C.value?(n(),p("div",St,[B(Y,{isLoading:C.value},null,8,["isLoading"])])):(n(),p("span",Tt,Bt))]),_:1}),B(x(z),null,{default:F(()=>[v.value.docs&&v.value.docs.length>0&&!T.value?(n(),E(gt,{key:0,chatrooms:v.value.docs?v.value.docs:[]},null,8,["chatrooms"])):T.value?(n(),p("div",Et,[B(Y,{isLoading:T.value},null,8,["isLoading"])])):(n(),p("span",Lt,Nt))]),_:1}),B(x(z),null,{default:F(()=>[h.value.docs&&h.value.docs.length>0&&!a.value?(n(),E(Me,{key:0,bids:h.value.docs?h.value.docs:[]},null,8,["bids"])):a.value?(n(),p("div",Ft,[B(Y,{isLoading:a.value},null,8,["isLoading"])])):(n(),p("span",qt,Dt))]),_:1})]),_:1})])):W("",!0)]))}});export{jt as default};
